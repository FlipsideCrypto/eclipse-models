version: 2
models:
  - name: silver__labels
    recent_date_filter: &recent_date_filter
      config:
        where: modified_timestamp >= current_date - 7
    columns:
      - name: BLOCKCHAIN
        description: "{{ doc('blockchain') }}"
        tests:
          - not_null: *recent_date_filter
      - name: ADDRESS
        description: "{{ doc('address') }}"
        tests:
          - not_null: *recent_date_filter
      - name: CREATOR
        description: "{{ doc('creator') }}"
      - name: LABEL_TYPE
        description: "{{ doc('label_type') }}" 
      - name: LABEL_SUBTYPE
        description: "{{ doc('label_subtype') }}"
      - name: ADDRESS_NAME
        description: "{{ doc('address_name') }}"
      - name: PROJECT_NAME
        description: "{{ doc('project_name') }}"
      - name: _IS_DELETED
      - name: LABELS_ID
        description: "{{ doc('pk') }}"
        data_tests: 
          - not_null:
              name: test_silver__not_null_labels_pk
              <<: *recent_date_filter
      - name: INSERTED_TIMESTAMP
        description: "{{ doc('inserted_timestamp') }}"   
        data_tests: 
          - not_null: *recent_date_filter
      - name: MODIFIED_TIMESTAMP
        description: "{{ doc('modified_timestamp') }}" 
      - name: _INVOCATION_ID
        description: "{{ doc('_invocation_id') }}" 
        data_tests: 
          - not_null:
              name: test_silver__not_null_labels_invocation_id
              <<: *recent_date_filter
      